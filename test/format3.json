{
  "functions": [
    "def f1(x,r,df): return 1/x",
    "def f2(x,r,df): return 4/x",
    "def f3(x,r,df): x[\"hey\"] = \"ho\"; return x",
    "def f4(df,col): return df[col].fillna(0)"
  ],
  "column_transforms": [
    {
      "col": "discount_factor",
      "func": "lambda df,col: df[col]*6"
    },
    {
      "col": "new_col",
      "func": "lambda df, col: df[\"discount_factor\"]/3"
    }
  ],
  "mapping": {
    "type": "array",
    "children": [
      {
        "type": "object",
        "multiple": true,
        "func": "f3",
        "group_by": "df[\"name\"]",
        "children": [
          {
            "name": "action",
            "value": "ADD_IR"
          },
          {
            "name": "currency",
            "value_col": "name"
          },
          {
            "type": "array",
            "name": "ir_curves",
            "children": [
              {
                "type": "object",
                "children": [
                  {
                    "type": "array",
                    "name": "points",
                    "children": [
                      {
                        "type": "object",
                        "multiple": true,
                        "children": [
                          {
                            "value_col": "date",
                            "name": "date"
                          },
                          {
                            "value_col": "discount_factor",
                            "func": "lambda x,r,o: 1/x",
                            "name": "df"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "name": "type",
                    "value": "BASE_CURVE"
                  },
                  {
                    "name": "identifier",
                    "func": "lambda x,r,o: x",
                    "value_col": "name"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}